<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 數位戰情室 // 測驗系統</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #050510;
            --card-bg: rgba(16, 20, 35, 0.9);
            --neon-cyan: #00f3ff;
            --neon-pink: #bc13fe;
            --text-main: #e0e6ed;
            --text-dim: #8b9bb4;
            --success: #00ff41;
            --danger: #ff2a2a;
        }

        body {
            font-family: 'Share Tech Mono', "Microsoft JhengHei", monospace;
            background-color: var(--bg-color);
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            color: var(--text-main);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        /* 頂部掃描線特效 */
        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: -1;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* 懸浮計時器 */
        .hud-timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--neon-cyan);
            color: var(--neon-cyan);
            padding: 10px 25px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            z-index: 1000;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
            letter-spacing: 2px;
            clip-path: polygon(15px 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%, 0 15px);
            display: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 15px rgba(0, 243, 255, 0.3); border-color: var(--neon-cyan); }
            50% { box-shadow: 0 0 25px rgba(0, 243, 255, 0.6); border-color: #fff; }
            100% { box-shadow: 0 0 15px rgba(0, 243, 255, 0.3); border-color: var(--neon-cyan); }
        }

        .container {
            width: 100%;
            max-width: 850px;
            background: var(--card-bg);
            border: 1px solid var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.15);
            padding: 40px;
            margin-top: 40px;
            margin-bottom: 40px;
            position: relative;
            backdrop-filter: blur(5px);
            clip-path: polygon(
                20px 0, 100% 0, 
                100% calc(100% - 20px), calc(100% - 20px) 100%, 
                0 100%, 0 20px
            );
            animation: slideIn 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 裝飾角落 */
        .container::after {
            content: "";
            position: absolute;
            top: 0; right: 0;
            width: 100px; height: 100px;
            border-top: 2px solid var(--neon-cyan);
            border-right: 2px solid var(--neon-cyan);
            border-top-right-radius: 5px;
            pointer-events: none;
        }

        h1 {
            font-family: 'Orbitron', "Microsoft JhengHei", sans-serif;
            text-align: center;
            color: var(--neon-cyan);
            font-size: 2.2em;
            letter-spacing: 3px;
            text-shadow: 0 0 10px var(--neon-cyan);
            margin-bottom: 40px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.2);
            padding-bottom: 15px;
        }

        /* 選單樣式 */
        .control-panel {
            margin-bottom: 20px;
            text-align: center;
        }

        .cyber-select {
            background: rgba(0, 243, 255, 0.1);
            color: var(--neon-cyan);
            border: 1px solid var(--neon-cyan);
            padding: 10px 20px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1em;
            cursor: pointer;
            outline: none;
            margin-left: 10px;
        }
        
        .cyber-select option {
            background: #050510;
            color: var(--neon-cyan);
        }

        /* 統計區塊 */
        .stats-box {
            background: rgba(0, 243, 255, 0.05);
            border-left: 4px solid var(--neon-pink);
            padding: 20px;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .stats-grid {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--neon-pink);
            font-weight: bold;
            font-family: 'Orbitron', "Microsoft JhengHei";
        }

        #freq-missed-list {
            list-style: none;
            padding: 0;
            margin-top: 15px;
            border-top: 1px dashed var(--text-dim);
        }

        #freq-missed-list li {
            padding: 10px 0;
            color: var(--text-dim);
            font-size: 0.9em;
        }

        /* 按鈕設計 */
        .btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: rgba(0, 243, 255, 0.1);
            color: var(--neon-cyan);
            border: 1px solid var(--neon-cyan);
            font-family: 'Orbitron', "Microsoft JhengHei", sans-serif;
            font-size: 1.2em;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            background: var(--neon-cyan);
            color: #000;
            box-shadow: 0 0 20px var(--neon-cyan);
            font-weight: bold;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--text-dim);
            color: var(--text-dim);
            padding: 5px 15px;
            font-family: "Microsoft JhengHei", monospace;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .btn-outline:hover {
            border-color: var(--danger);
            color: var(--danger);
            text-shadow: 0 0 5px var(--danger);
        }

        /* 進度條 */
        .progress-container {
            width: 100%;
            height: 4px;
            background: #222;
            margin-bottom: 30px;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--neon-pink);
            width: 0%;
            box-shadow: 0 0 10px var(--neon-pink);
            transition: width 0.3s linear;
        }

        .progress-text {
            text-align: right;
            color: var(--neon-cyan);
            font-size: 0.9em;
            margin-bottom: 5px;
            font-family: 'Orbitron';
        }

        /* 題目卡片 */
        .question-card {
            margin-bottom: 40px;
            border-bottom: 1px dashed rgba(255,255,255,0.1);
            padding-bottom: 20px;
        }

        .question-text {
            font-size: 1.3em;
            color: var(--white);
            margin-bottom: 25px;
            line-height: 1.6;
            text-shadow: 0 0 2px rgba(255,255,255,0.5);
        }

        /* 選項設計 */
        .options {
            display: grid;
            gap: 15px;
        }

        .options label {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }

        .options label:hover {
            border-color: var(--neon-cyan);
            background: rgba(0, 243, 255, 0.05);
        }

        .options label.selected {
            border-color: var(--neon-cyan);
            background: rgba(0, 243, 255, 0.15);
            box-shadow: inset 0 0 10px rgba(0, 243, 255, 0.2);
        }

        .options label::before {
            content: ">>";
            color: var(--text-dim);
            margin-right: 15px;
            font-family: 'Share Tech Mono';
            transition: 0.2s;
        }

        .options label.selected::before {
            color: var(--neon-cyan);
            content: "SELECTED_";
        }

        .options input[type="radio"] {
            display: none;
        }

        /* 結果頁面 */
        .result-info {
            border: 1px solid var(--neon-pink);
            background: rgba(188, 19, 254, 0.05);
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(188, 19, 254, 0.2);
        }

        .result-info h2 {
            font-family: 'Orbitron';
            color: var(--neon-pink);
            font-size: 3.5em; 
            margin: 0;
            text-shadow: 0 0 20px var(--neon-pink);
        }
        
        .score-unit {
            font-size: 0.4em;
            opacity: 0.8;
        }

        .result-item {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            margin-top: 15px;
            border-left: 3px solid var(--danger);
        }

        .correct-ans-display {
            margin-top: 10px;
            color: var(--success);
            font-weight: bold;
            padding: 5px 0;
            border-top: 1px dotted #444;
            text-shadow: 0 0 5px var(--success);
        }

        .explanation {
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--text-dim);
        }

        .hidden { display: none !important; }

        @media (max-width: 600px) {
            .container { padding: 20px; margin-top: 60px; clip-path: none; border: none; border-top: 2px solid var(--neon-cyan);}
            h1 { font-size: 1.5em; }
            .question-text { font-size: 1.1em; }
            .hud-timer { font-size: 1.2em; padding: 8px 15px; top: 10px; right: 10px; }
        }
    </style>
</head>
<body>

<div id="quiz-timer" class="hud-timer">00:00</div>

<div class="container">
    <h1>DIGITAL WARROOM // AI 戰情測驗</h1>
    
    <div id="start-screen">
        <div class="stats-box">
            <div class="stats-grid">
                <span>SYSTEM STATUS (系統狀態)</span>
                <span>測驗次數: <span id="total-attempts">0</span></span>
            </div>
            
            <div class="control-panel" style="margin-top: 20px; border-top: 1px dashed var(--text-dim); padding-top: 15px;">
                <label style="color: var(--neon-cyan); font-weight: bold;">SELECT QUANTITY (選擇題數): </label>
                <select id="question-count" class="cyber-select">
                    <option value="10">10 題 (快速)</option>
                    <option value="25">25 題 (標準)</option>
                    <option value="50" selected>50 題 (挑戰)</option>
                </select>
            </div>

            <p style="color: var(--text-dim); margin-top: 15px;">// 錯誤率分析 (TOP 5)</p>
            <ul id="freq-missed-list">NO DATA // 無資料</ul>
            <div style="text-align: right; margin-top: 15px;">
                <button onclick="resetStats()" class="btn-outline">[RESET SYSTEM DATA / 清除紀錄]</button>
            </div>
        </div>
        <button class="btn" onclick="startQuiz()">INITIALIZE // 啟動測驗程序</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div class="progress-text">PROGRESS <span id="progress-num">1</span> / <span id="total-q-num">50</span></div>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div id="questions-container"></div>
        <button class="btn" onclick="submitQuiz()">// SUBMIT DATA // 提交數據</button>
    </div>

    <div id="result-screen" class="hidden">
        <div class="result-info">
            <div style="font-size: 0.9em; color: var(--neon-pink); letter-spacing: 2px; margin-bottom: 10px;">MISSION REPORT // 任務報告</div>
            <h2 id="score-display">0 <span class="score-unit">%</span></h2>
            <div id="score-detail-text" style="color: var(--text-main); margin-top: 10px; font-weight: bold;"></div>
            <div id="time-display" style="margin-top: 10px; color: var(--text-dim); font-family: 'Share Tech Mono';"></div>
        </div>
        <div id="wrong-answers-review"></div>
        <button class="btn" onclick="location.reload()">RESTART SYSTEM // 重新啟動</button>
    </div>
</div>

<script>
// 題庫數據 (請保留這部分，並填入您完整的數據)
const rawData = [
      {q: "一對一網路行銷（One-to-One Web Marketing）的主要目的是提升什麼？", o: ["顧客購買率與利潤", "產品生產速度", "員工滿意度", "辦公室租金"], a: 0},
    {q: "企業分析使用者需求後呈現不同的廣告內容，這是實現什麼策略？", o: ["標準化行銷", "大眾化行銷", "個人化行銷", "匿名化行銷"], a: 2},
    {q: "當使用者購買或搜尋產品時，企業能立即由資料庫取得資訊分析，這是？", o: ["離線資訊處理", "即時資訊處理", "人工手寫處理", "延遲資訊處理"], a: 1},
    {q: "Nike 讓消費者依照喜好設計專屬鞋款，屬於哪種類型的一對一行銷？", o: ["社群參與", "使用者選擇主題", "隨機分配服務", "量身訂製服務"], a: 3},
    {q: "在一對一行銷的建立過程中，「Identify」代表的是？", o: ["顧客確認化", "顧客區隔化", "顧客互動化", "顧客客製化"], a: 0},
    {q: "區分高價值與低價值顧客，針對不同需求提供服務，屬於建立過程中的？", o: ["顧客確認化", "顧客區隔化", "顧客客製化", "顧客互動化"], a: 1},
    {q: "改變網路行銷方式來符合顧客個人化需求，屬於建立過程中的？", o: ["顧客確認化", "顧客區隔化", "顧客客製化", "顧客互動化"], a: 2},
    {q: "自動獲取可強化顧客關係的資訊，提升互動效益，屬於建立過程中的？", o: ["顧客確認化", "顧客區隔化", "顧客客製化", "顧客互動化"], a: 3},
    {q: "下列何者是一對一網路行銷的迷思？", o: ["資料庫預測度高", "成本極低", "不需要技術", "僅適用於大企業"], a: 0},
    {q: "建立以顧客為中心的企業文化，是為了提升顧客的？", o: ["年齡", "忠誠度", "身高", "體重"], a: 1},
    {q: "專職團隊的建立應結合媒體、電腦與學術等單位，並由企業內部充分？", o: ["限制", "監督", "授權", "隔離"], a: 2},
    {q: "成功的網站應提供具有什麼特色的使用介面？", o: ["親和性", "複雜性", "神秘性", "排他性"], a: 0},
    {q: "口碑（Word-of-Mouth）可以視為一種具有影響力的什麼過程？", o: ["機器學習", "物理反應", "化學變化", "人際溝通"], a: 3},
    {q: "訊息傳遞過程涉及接收者（Receiver）與誰之間的溝通？", o: ["駭客", "傳送者 (Sender)", "旁觀者", "操作員"], a: 1},
    {q: "網路口碑透過數位平台實現什麼效應，使訊息能在短時間觸及廣泛受眾？", o: ["縮減效應", "隔離效應", "擴散效應", "消失效應"], a: 2},
    {q: "消費者往往更信任哪一方的評價？", o: ["第三方評價 (其他消費者)", "官方廣告", "虛假新聞", "競爭對手抹黑"], a: 0},
    {q: "網路口碑不受下列哪項限制，傳播速度更快？", o: ["頻寬限制", "語言限制", "年齡限制", "時間和地點限制"], a: 3},
    {q: "在推行網路口碑的 5T 模型中，『Talker』是指？", o: ["話題", "談論者", "工具", "追蹤"], a: 1},
    {q: "識別產品的意見領袖或市場行家，是 5T 模型中的哪一項？", o: ["找出談論者", "設計話題", "善用工具", "主動參與"], a: 0},
    {q: "設計便於傳遞的內容和獎勵機制，是 5T 模型中的哪一項？", o: ["找出談論者", "善用工具", "設計話題", "持續追蹤"], a: 2},
    {q: "利用郵件、網路社群或留言版傳遞資訊，屬於 5T 模型中的？", o: ["找出談論者", "設計話題", "持續追蹤", "善用工具"], a: 3},
    {q: "企業深入了解消費者需求並提高推行意願，屬於 5T 模型中的？", o: ["設計話題", "主動參與", "善用工具", "找出談論者"], a: 1},
    {q: "透過口碑追蹤了解談論者背景，可以降低企業的什麼成本？", o: ["市場調查成本", "物流成本", "倉儲成本", "生產成本"], a: 0},
    {q: "衡量指標中，顧客會向他人指出企業問題的程度稱為？", o: ["正面口碑強度", "口碑內容分析", "負面口碑強度", "口碑整體強度"], a: 2},
    {q: "行動行銷（Mobile Marketing）利用行動終端設備並經由什麼網路串連？", o: ["有線電話網", "實體郵寄網", "電視廣播網", "無線通訊網路"], a: 3},
    {q: "行動行銷突破了傳統行銷的什麼限制？", o: ["時間和空間限制", "預算限制", "創意限制", "人力限制"], a: 0},
    {q: "第 1 代行動通訊（1G）開始於哪一年？", o: ["1970 年", "1979 年", "1992 年", "2000 年"], a: 1},
    {q: "第 2 代行動通訊（2G）採用的技術標準不包括下列何者？", o: ["GSM", "CDMA", "WCDMA", "TDMA"], a: 2},
    {q: "第 5 代行動通訊（5G）的速度最高可達？", o: ["10 Mbps", "100 Mbps", "1 Gbps", "10 Gbps"], a: 3},
    {q: "5G 支援的應用場景不包括下列何者？", o: ["純類比語音傳輸", "車聯網", "物聯網", "智慧城市"], a: 0},
    {q: "行動通訊設備容易遭竊或資料被攔截，屬於哪種影響因素？", o: ["病毒威脅", "資料外洩", "頻寬不足", "手機限制"], a: 1},
    {q: "第一個手機病毒 Cabir 出現，體現了行動行銷的哪種威脅？", o: ["硬體損壞", "電量耗盡", "病毒威脅", "網路中斷"], a: 2},
    {q: "5G 實際連線速度容易受周遭環境干擾，這屬於？", o: ["安全隱憂", "介面過小", "耗電量大", "頻寬、速度不足"], a: 3},
    {q: "行動商務成功的關鍵在於便利性，即使用者能？", o: ["隨時隨地接收正確服務", "買到最便宜產品", "看到最多廣告", "獲得實體贈品"], a: 0},
    {q: "行動商務成功的關鍵在於使用性，即提供什麼樣的操作介面？", o: ["華麗複雜", "簡單、直覺式", "隨機變換", "需要說明書"], a: 1},
    {q: "行動商務中的「個人性」是指針對每位用戶提供什麼資訊？", o: ["隨機推薦", "廣告資訊", "位置相關或個人化服務", "全球通用資訊"], a: 2},
    {q: "行動商務在有限螢幕尺寸下提供齊全功能與簡潔格式，這稱為？", o: ["簡潔化", "多媒體性", "豐富性", "複雜化"], a: 0},
    {q: "無線網路讓用戶透過隨身設備上網，這體現了行動商務的哪項效益？", o: ["連線快速化", "追蹤便捷化", "資訊保密化", "傳輸無線化"], a: 3},
    {q: "5G 行動通訊大幅提升數據傳輸速度，體現了哪項效益？", o: ["傳輸無線化", "連線快速化", "追蹤便捷化", "使用個人化"], a: 1},
    {q: "透過行動通訊網路可以隨時追蹤使用者位置，屬於？", o: ["傳輸無線化", "連線快速化", "追蹤便捷化", "資訊保密化"], a: 2},
    {q: "行動通訊網路安全性比有線網路高，主要是藉由什麼技術？", o: ["更長的傳輸線", "更多的使用者", "更大的螢幕", "SIM 智慧卡及加密技術"], a: 3},
    {q: "網路高度發展下，企業由傳統行銷轉向哪種更符合需求的模式？", o: ["一對一網路行銷", "無差異化行銷", "大眾傳播行銷", "被動行銷"], a: 0},
    {q: "消費者意識抬頭，在網路口碑模式下消費者會主動產生什麼行為？", o: ["退貨", "推薦", "投訴", "關機"], a: 1},
    {q: "整合一對一行銷、網路口碑與行動行銷，能比競爭者更快建立？", o: ["辦公大樓", "供應鏈", "市場優勢 (競爭優勢)", "員工人數"], a: 2},
    {q: "amazon.com 推薦書單給使用者，是基於哪種分析？", o: ["使用者需求分析", "員工人數分析", "公司利潤分析", "產品重量分析"], a: 0},
    {q: "在一對一建立過程中，取得最具有價值顧客的詳盡資料，是？", o: ["顧客客製化", "顧客確認化", "顧客區隔化", "顧客互動化"], a: 1},
    {q: "手機本身的限制不包括下列哪一項？", o: ["耗電量大", "螢幕過小", "鍵盤介面過小", "傳輸速度無限大"], a: 3},
    {q: "哪一代行動通訊開始提供網際網路、影音、多媒體傳輸服務？", o: ["第 1 代", "第 2 代", "第 3 代", "第 4 代"], a: 2},
    {q: "行動商務的「豐富性」是指讓使用者能？", o: ["靈活使用網路服務", "看到更多顏色", "聽到更多音樂", "下載更多遊戲"], a: 0},
    {q: "5G 採用的 28GHz 毫米波屬於哪一代的通訊技術？", o: ["4G", "5G", "3G", "2G"], a: 1},
    {q: "數位時代中，人人都有機會成為內容創作者或什麼？", o: ["意見領袖 (KOL)", "程式開發員", "物流司機", "數據中心主任"], a: 0},
    {q: "行動裝置迅速成長，導致使用者對哪種應用的需求提升？", o: ["大型伺服器", "實體書信", "個人行銷應用", "固定電話"], a: 2},
    {q: "自媒體（We Media）也被稱為下列何者？", o: ["企業媒體", "個人媒體", "官方媒體", "被動媒體"], a: 1},
    {q: "自媒體成功的關鍵在於只要能吸引網路使用者做什麼，就能創造商機？", o: ["點擊廣告", "購買產品", "下載 App", "跟隨 (Follow)"], a: 3},
    {q: "只要有創新的想法，就能透過哪種平台進行分享並實現創意？", o: ["社群網站或群眾募資平台", "銀行借貸系統", "公司內部通訊", "官方公報"], a: 0},
    {q: "網路平台使每個人都能建立獨特的形象與價值主張，這稱為個人？", o: ["公司化", "專業化", "品牌化", "匿名化"], a: 2},
    {q: "個人透過社群網路創造全新的什麼，實現價值的同時獲得回報？", o: ["辦公室", "營運模式", "稅收制度", "法規體體系"], a: 1},
    {q: "「黃阿瑪的後宮生活」粉絲團展現了自媒體的什麼潛力？", o: ["法律潛力", "技術潛力", "教育潛力", "商業潛力"], a: 3},
    {q: "自媒體最基本的特點是「平民化」，即素人從閱讀者轉型為？", o: ["資訊提供者", "被動訂閱者", "系統管理員", "數據分析師"], a: 0},
    {q: "在網路時代，自媒體使用者可以以什麼方式進行資訊傳遞？", o: ["高成本門檻", "專業媒體中介", "低成本傳遞", "官方授權"], a: 2},
    {q: "自媒體打破了傳統媒體的資訊壟斷，使資訊流動更加？", o: ["封閉", "自由與即時", "昂貴", "緩慢"], a: 1},
    {q: "「愛料理」網站讓普通人分享食譜，體現了自媒體的什麼特性？", o: ["專業高度要求", "高進入門檻", "內容單一", "平民化與低門檻"], a: 3},
    {q: "自媒體的進階特點中，資訊在網友彼此間傳遞，屬於？", o: ["多對多傳播模式", "一對多傳播模式", "點對點封閉模式", "廣播模式"], a: 0},
    {q: "自媒體內容多樣化，原因在於創作者提供的內容會因為什麼而有很大差異？", o: ["硬體設備", "專業程度差異", "網路速度", "使用時間"], a: 1},
    {q: "網友可自主成立媒體進行資料傳遞，內容按個人想法而定，體現了？", o: ["高度監管性", "社會一致性", "內容多樣化", "技術單一性"], a: 2},
    {q: "創作者從導演到配音全由自己決定，這展現了？", o: ["集體決策", "官方委託", "粉絲要求", "創作自主性"], a: 3},
    {q: "YouTube 的什麼計畫支持創作者透過內容獲得收益，促進專業化？", o: ["合作夥伴計畫", "廣告投放計畫", "資料收集計畫", "會員註冊計畫"], a: 0},
    {q: "Meta 是大多數網路使用者都具備的平台，其功能不包括？", o: ["個人帳號", "實體百貨公司", "粉絲專頁", "社團"], a: 1},
    {q: "在任何領域具備專長並持續發文，能樹立品牌形象成為？", o: ["數據庫", "系統開發者", "意見領袖 (Opinion Leader)", "普通使用者"], a: 2},
    {q: "願意將所擁有的分享他人，讓自己成為充滿故事的人，體現了？", o: ["分享力", "競爭力", "採購力", "決策力"], a: 0},
    {q: "散發積極、正向想法讓其他使用者願意持續互動，體現了？", o: ["成本力", "銷售力", "採購力", "快樂力與個人魅力"], a: 3},
    {q: "在 Meta 平台上成功轉換商務模式的核心，是成為朋友間的什麼？", o: ["孤島", "樞紐 (Hub)", "追蹤者", "觀察者"], a: 1},
    {q: "「行銷資料科學」社團透過分享專業知識，在該領域建立了？", o: ["利潤來源", "物流系統", "權威性", "硬體設施"], a: 2},
    {q: "LINE 提供的行銷功能不包括下列哪一項？", o: ["實體現金傳送", "官方帳號", "貼文功能", "基本聊天"], a: 0},
    {q: "特別適合視覺導向個人品牌建立的平台是？", o: ["LinkedIn", "官方網站", "電子報", "Pinterest 或 Instagram"], a: 3},
    {q: "Instagram 使用者透過什麼效果後分享圖片，成為視覺內容理想平台？", o: ["背景移除", "濾鏡效果", "音訊編輯", "代碼混淆"], a: 1},
    {q: "LinkedIn 以什麼為導向，適合專業人士建立商業人脈？", o: ["娛樂導向", "遊戲導向", "商業導向", "購物導向"], a: 2},
    {q: "在社群行銷中，選擇適合的平台應根據內容類型與什麼來決定？", o: ["目標受眾 (Target Audience)", "創作者年齡", "伺服器地點", "顯示器尺寸"], a: 0},
    {q: "個人網路與社群行銷的未來展望不包括？", o: ["個人品牌價值最大化", "多元化收入來源", "社群互動經營", "恢復單向大眾媒體模式"], a: 3},
    {q: "群眾募資平台的主要功能是讓個人能在網路上？", o: ["檢舉他人", "募集資金將創意化為實際", "下載非法軟體", "進行匿名攻擊"], a: 1},
    {q: "自媒體讓資訊流通打破了地理位置，使網友可與誰進行互動？", o: ["其他網友", "僅限鄰居", "僅限家人", "機器人"], a: 0},
    {q: "Meta 平台的「專業力」是指在任何領域具有什麼的能力？", o: ["忽略他人", "阻礙他人", "幫助他人", "監視他人"], a: 2},
    {q: "「台灣高等教育產業工會」社團在 Meta 平台上的角色是？", o: ["私人購物頻道", "議題交流與討論平台", "遊戲競技場", "數據儲存中心"], a: 1},
    {q: "下列何者是個人媒體透過持續輸出優質內容累積粉絲後的結果？", o: ["被平台封鎖", "喪失個人隱私", "社會孤立", "形成商業價值"], a: 3},
    {q: "自媒體的普及使自媒體開始普及並成為主流的什麼方式？", o: ["傳播方式", "生產方式", "計算方式", "建築方式"], a: 0},
    {q: "「一日系列」影片在 YouTube 的成功，說明了哪種平台的力量？", o: ["文字平台", "圖片平台", "影音平台", "通訊平台"], a: 2},
    {q: "個人行銷應用中，提到能讓創意有機會實現的是什麼思維？", o: ["固定思維", "創新思維", "批判思維", "邏輯思維"], a: 1},
    {q: "行動裝置對個人行銷的影響不包括？", o: ["隨時隨地發布", "增加觸及率", "建立個人品牌", "減少網路需求"], a: 3},
    {q: "We Media 的特點中，「多對多傳播」是指人人都是？", o: ["媒體", "聽眾", "產品", "伺服器"], a: 0},
    {q: "個人行銷的核心目標之一是建立專屬於自己的個人什麼？", o: ["密碼", "辦公桌", "品牌 (Brand)", "電腦"], a: 2},
    {q: "Pinterest 的主要功能是讓使用者將圖片釘到自己的？", o: ["實體牆壁", "線上相片簿", "購物籃", "回收桶"], a: 1},
    {q: "下列何者不屬於 Meta 平台的個人行銷範疇？", o: ["操作工廠機器", "經營粉絲專頁", "建立社群社團", "管理個人帳號"], a: 0},
    {q: "意見領袖（Opinion Leader）通常具備什麼特徵？", o: ["不參與社交", "隱藏專業知識", "隨大流", "在特定領域有影響力"], a: 3},
    {q: "自媒體普及化讓個人影響力得以？", o: ["縮減", "消失", "擴大", "保持不變"], a: 2},
    {q: "YouTube 合作夥伴計畫的主要目的是？", o: ["增加伺服器負擔", "讓創作者獲得收益", "限制影片長度", "增加廣告投放難度"], a: 1},
    {q: "個人行銷中，持續產出優質內容屬於？", o: ["內容創作與分享", "平台選擇", "收入來源", "法律風險"], a: 0},
    {q: "自媒體平民化特點中，發表想法不再受限於傳統媒體的？", o: ["頻寬", "語言", "電量", "門檻"], a: 3},
    {q: "社群平台 LinkedIn 的使用者互動是為了建立？", o: ["敵對關係", "商業人脈", "親屬關係", "遊戲戰隊"], a: 1},
    {q: "個人行銷未來可能看到更多創新的什麼，幫助創作者建立品牌？", o: ["硬體工具", "法規條文", "平台與工具", "實體商店"], a: 2},
    {q: "本章介紹個人行銷應用，核心是每個網路使用者都可成為？", o: ["自媒體", "系統開發者", "被動接收者", "硬體供應商"], a: 0},
    {q: "影音社群（Video Community）主要是透過影像來凝聚什麼？", o: ["社群", "實體貨幣", "辦公室成員", "機器人"], a: 0},
    {q: "短影音（Short Video）通常是指長度在多少分鐘內的影片？", o: ["60 分鐘", "30 分鐘", "15 分鐘", "5 分鐘"], a: 3},
    {q: "短影音融合文字、圖片、影片，並直覺地提供編撰者的？", o: ["秘密資料", "想法", "財務報表", "程式碼"], a: 1},
    {q: "影音社群的特色中，哪一項能讓創作者快速產出內容？", o: ["發展自我特色", "雙向互動需求", "豐富資料需求", "製作快速便利"], a: 3},
    {q: "使用者在影音社群中追求快速、簡單的內容，這是？", o: ["快速娛樂需求", "豐富資料需求", "歸屬感需求", "雙向互動需求"], a: 0},
    {q: "創作者與觀看者之間的按讚、回饋行為體現了？", o: ["快速娛樂需求", "豐富資料需求", "雙向互動需求", "製作快速便利"], a: 2},
    {q: "觀看影片後產生的按讚、分享行為，屬於影片的？", o: ["產出", "回饋", "加密", "備份"], a: 1},
    {q: "影音社群中，使用者追求具有個人獨特風格的帳號，這是？", o: ["快速娛樂需求", "雙向互動需求", "製作快速便利", "發展自我特色"], a: 3},
    {q: "經營影音社群時，第一步應先制定什麼？", o: ["目標與經營目的", "影片配樂", "廣告預算", "員工薪資"], a: 0},
    {q: "持續發布影片應挑選自己有興趣且什麼的方向？", o: ["最貴的", "最難的", "擅長的", "隨機的"], a: 2},
    {q: "關注影片回饋時，應注意內容的什麼，讓觀看者產生興趣？", o: ["檔案大小", "流暢度", "加密強度", "拍攝時間"], a: 1},
    {q: "在影片中設定長文章，目的是為了拉長觀看者在影片上的？", o: ["螢幕亮度", "電量消耗", "音量大小", "停留時間"], a: 3},
    {q: "影音社群經營很難一次火紅，需要透過不斷地？", o: ["反覆設定測試", "購買廣告", "更換帳號", "刪除影片"], a: 0},
    {q: "影音社群平台具備分析觀看次數、按讚數的功能，這稱為？", o: ["個人帳號模式", "企業帳號模式", "匿名帳號模式", "測試帳號模式"], a: 1},
    {q: "內容必須要有特定的主題與方向，這屬於哪種經營模式？", o: ["隨機經營模式", "大眾經營模式", "專業經營模式", "業餘經營模式"], a: 2},
    {q: "利用粉絲喜歡的內容進行經營，並讓粉絲有歸屬感，是？", o: ["粉絲導向模式", "競爭者導向模式", "產品導向模式", "成本導向模式"], a: 0},
    {q: "初期不知道拍什麼時，可以參考熱門帳號並加入自我也素，這是？", o: ["抄襲他人", "官方委託", "放棄經營", "跟風熱門議題"], a: 3},
    {q: "越來越多企業發展協助後製影片的服務，體現了什麼模式？", o: ["簡單製作模式", "專業影片製作", "隨機錄製模式", "手機直拍模式"], a: 1},
    {q: "建立一個專精銷售特定商品的帳號，是哪種導向？", o: ["娛樂導向", "教育導向", "商品銷售導向", "慈善導向"], a: 2},
    {q: "透過特定標籤進行促銷並讓使用者在同標籤下分享影片，是？", o: ["標籤及推廣模式", "密碼加密模式", "封閉社群模式", "傳統廣告模式"], a: 0},
    {q: "影音平台透過哪項功能將標籤下的影片傳送到更多人眼前？", o: ["刪除", "隱藏", "加密", "推廣"], a: 3},
    {q: "TikTok 的預設影片時間通常在多久之內結束？", o: ["5 秒", "1 分鐘", "10 分鐘", "1 小時"], a: 1},
    {q: "YouTube 推薦影片機制主要是根據使用者的什麼？", o: ["年齡", "性別", "先前觀看紀錄", "帳戶餘額"], a: 2},
    {q: "YouTube Shorts 是長度在多少秒以內的直立式影片？", o: ["60 秒", "15 秒", "30 秒", "120 秒"], a: 0},
    {q: "Meta 推出的短影音功能名稱為何？", o: ["Shorts", "TikTok", "IG TV", "Reels"], a: 3},
    {q: "Reels Play 獎勵計畫是讓創作者可以？", o: ["免交稅", "賺取收益", "購買裝備", "獲得實體獎盃"], a: 1},
    {q: "短影音市場目前非常熱絡，反映了什麼的變化？", o: ["網路使用者偏好", "硬體成本上升", "法律限制放寬", "電力供應充足"], a: 0},
    {q: "YouTube 影片的核心元素之一是可以在影片中置入大量的？", o: ["雜訊", "錯誤代碼", "資訊", "浮水印"], a: 2},
    {q: "影音社群實例中，Khaby Lame 是在哪一個平台走紅？", o: ["LinkedIn", "TikTok", "Pinterest", "LINE"], a: 1},
    {q: "影音社群規劃中，為了讓創作者不覺無聊，內容應？", o: ["越難越好", "隨便拍拍", "模仿競爭對手", "讓自己感到開心"], a: 3},
    {q: "短影音屬於網路什麼傳播方式的一種？", o: ["內容傳播", "物理傳播", "聲波傳播", "郵寄傳播"], a: 0},
    {q: "行動設備普及，使用者主要利用什麼拍攝短影片？", o: ["專業攝影機", "桌上型電腦", "手機", "電視機"], a: 2},
    {q: "「夏日雲端音樂節」是利用影音平台進行的什麼活動？", o: ["實體會議", "標籤推廣活動", "硬體發布", "系統升級"], a: 1},
    {q: "YouTube 特有的短片格式是？", o: ["AVI", "MP4", "MOV", "YouTube Shorts"], a: 3},
    {q: "秋葉 Office 帳號是專門指導什麼軟體應用的影音社群？", o: ["Office", "Photoshop", "AutoCAD", "Windows"], a: 0},
    {q: "影音社群商業模式中，透過計費方式傳送影片稱為？", o: ["免費推廣", "付費推廣", "標籤設定", "影片後製"], a: 1},
    {q: "影音社群特色中，使用者能一則一則觀看產生興趣，體現？", o: ["製作快速", "豐富資料", "內容流暢度與吸引力", "歸屬感"], a: 2},
    {q: "TikTok 強調影片的什麼性，以產生大量傳播效果？", o: ["深度性", "靜止性", "系列性", "即時性"], a: 3},
    {q: "「寵物星球」標籤活動屬於哪種經營模式？", o: ["粉絲導向與標籤推廣", "企業帳號", "專業製作", "隨機經營"], a: 0},
    {q: "YouTube Shorts 主要是為了對抗哪個平台的崛起？", o: ["LinkedIn", "Pinterest", "TikTok", "Facebook"], a: 2},
    {q: "Reels 在台灣上線的時間大約是何時？", o: ["2015 年", "2022 年 4 月", "2010 年", "2018 年"], a: 1},
    {q: "企業經營者應善用短影音模式來創造更好的什麼成果？", o: ["採購", "生產", "行政", "行銷"], a: 3},
    {q: "短影音融合文字與圖片，直覺提供編撰者的想法，這是？", o: ["短影音特性", "傳統電視特性", "廣播特性", "報紙特性"], a: 0},
    {q: "影音社群特色「歸屬感需求」是為了讓使用者感到帳號存在是？", o: ["有壓力的", "無意義的", "有價值的且有吸引力的", "昂貴的"], a: 2},
    {q: "影音社群規劃中，建議「關注影片回饋」是為了掌握觀看者的？", o: ["秘密", "行為 (按讚、分享)", "存款", "住址"], a: 1},
    {q: "TikTok 與 YouTube 差異之一，TikTok 的影片通常？", o: ["具有縮圖", "需看 5 秒廣告", "畫面為橫向", "直接播放內容且無縮圖"], a: 3},
    {q: "影音社群的概念中，透過影音凝聚社群的模式稱為？", o: ["影音社群", "文字社群", "圖片社群", "語音社群"], a: 0},
    {q: "影片中設定長文章的觀感是為了讓觀看者覺得？", o: ["影片太長", "到底寫了什麼而停下來看", "影片太吵", "影片太暗"], a: 1},
    {q: "影音社群發展使自媒體創作者能達成品牌名稱、宣傳與？", o: ["增加庫存", "減少支出", "促進銷售", "增加債務"], a: 2},
    {q: "Meta for Creators 是針對哪種功能的創作者提供的？", o: ["搜尋", "購物", "通訊", "Reels"], a: 3},
    {q: "VTuber 的發源地是哪個國家？", o: ["日本", "韓國", "美國", "中國"], a: 0},
    {q: "VTuber 背後的真人配備動作捕捉裝置操控虛擬角色，這稱為？", o: ["自動化導覽", "AI 機器人", "扮演者/中之人", "語音助手"], a: 2},
    {q: "「Nijisanji」是日本哪家知名的 VTuber 事務所？", o: ["Cover", "彩虹社 (ANYCOLOR)", "Brud", "Sidus"], a: 1},
    {q: "VTuber 最主要的收入來源通常是什麼？", o: ["政府補助", "出售電腦", "銀行利息", "粉絲贊助 (Donate)"], a: 3},
    {q: "2022 年度日本 VTuber 市場規模約為多少億日元？", o: ["520 億", "100 億", "1000 億", "10 億"], a: 0},
    {q: "日本 VTuber 市場中，哪一項收益佔比最高 (約 51.3%)？", o: ["網路直播", "周邊商品", "B2B 工商", "活動門票"], a: 1},
    {q: "VTuber 市場規模已與哪種次文化不相上下？", o: ["實體運動", "傳統歌劇", "同人誌或交換卡片遊戲", "房地產"], a: 2},
    {q: "VTuber 特性在於其兼具 IP (智慧財產) 與什麼的特性？", o: ["網紅 (Influencer)", "軟體工程師", "硬體設備", "倉儲物流"], a: 0},
    {q: "日本 VTuber 母公司陸續在哪個交易所上市？", o: ["紐約交易所", "納斯達克", "倫敦交易所", "東京證券交易所"], a: 3},
    {q: "VTuber 虛擬的人物形象在業界被稱為什麼？", o: ["中之人", "皮 (Avatar)", "晶片", "骨架"], a: 1},
    {q: "VTuber 收益分析中，流量分紅大約每千次點閱可獲得新台幣多少？", o: ["100-200 元", "1-5 元", "30-40 元", "1000 元"], a: 2},
    {q: "「超級留言 (SC)」數據可以從哪個專門網站取得？", o: ["Playboard.co", "Google.com", "Amazon.com", "Facebook.com"], a: 0},
    {q: "頻道會員制開啟後，粉絲支付月費可獲得？", o: ["公司股份", "免稅證明", "現金回饋", "專屬徽章與表情符號"], a: 3},
    {q: "YouTube 平台會從 SC 中抽取多少比例的手續費？", o: ["50%", "30%", "10%", "5%"], a: 1},
    {q: "中國市場中洛天依在微博擁有百萬粉絲，她屬於？", o: ["真人歌手", "實體模特兒", "虛擬明星 (Virtual Celebrity)", "官方發言人"], a: 2},
    {q: "Lil Miquela 是在全球發展非常成功的虛擬網紅，她住在？", o: ["LA (洛杉磯)", "首爾", "東京", "台北"], a: 0},
    {q: "Web3 時代虛擬人物可以作為什麼形式發售，體驗資產增值？", o: ["實體門票", "銀行存款", "紙本證券", "數位藏品 (NFT)"], a: 3},
    {q: "推動元宇宙熱潮的主力族群是哪一代？", o: ["嬰兒潮世代", "MZ 世代", "沈默世代", "X 世代"], a: 1},
    {q: "Roblox 平台大受 Z 世代歡迎的主要原因不包括？", o: ["社交與賺錢", "仿真度高", "僅能單機遊玩", "自由創作"], a: 2},
    {q: "ZEPETO 平台是以什麼為主要目的的元宇宙？", o: ["溝通交流", "專業辦公", "系統開發", "硬體測試"], a: 0},
    {q: "GUCCI 與 ZEPETO 合作打造的虛擬空間名稱是？", o: ["GUCCI Land", "GUCCI Store", "GUCCI Office", "GUCCI Villa"], a: 3},
    {q: "D2A (Direct to Avatar) 模式是指將產品 directly 賣給？", o: ["消費者實體", "虛擬替身", "企業採購", "政府部門"], a: 1},
    {q: "韓國保險公司廣告出道的虛擬網紅名稱是？", o: ["Lil Miquela", "IMMA", "Rozy", "Shudu"], a: 2},
    {q: "Rozy 年齡永遠設定在幾歲？", o: ["22 歲", "18 歲", "25 歲", "30 歲"], a: 0},
    {q: "視覺藝術製作公司與三星合作推出的數位人物暱稱是？", o: ["Siri", "Alexa", "Cortana", "SAM (SamsungGirl)"], a: 3},
    {q: "LG 電子開發的虛擬網紅金來兒，其動作是利用什麼技術？", o: ["手工繪圖", "3D 動態捕捉", "隨機生成", "真人替身"], a: 1},
    {q: "「動態立體捕捉 (Volumetric Capture)」技術產生的數據稱為？", o: ["雨雲", "星雲", "點雲 (Point Cloud)", "煙霧"], a: 2},
    {q: "虛擬女性員工 Amelia 每個月的薪水大約是多少美元？", o: ["1800", "10000", "5000", "500"], a: 0},
    {q: "AI 代言人的效益中，「同時啟動多市場」是指具備什麼能力？", o: ["多硬體兼容", "多幣種支付", "多物流渠道", "多語言能力與同步覆蓋"], a: 3},
    {q: "數位分身 DHA (Digital Human Agent) 具備哪三大特徵？", o: ["只有外觀", "多模態互動、自主性、規模化", "需要中之人、單一功能", "昂貴、封閉、複雜"], a: 1},
    {q: "HeyGen 創辦人 Joshua Xu 利用自己的什麼錄製產品發布會？", o: ["實體影片", "錄音帶", "AI 數位分身", "照片"], a: 2},
    {q: "生成式 AI 打造分身時，學習名人說話風格的部分稱為？", o: ["大腦與靈魂 (LLM)", "外觀生成 (NeRF)", "聲音克隆", "嘴型同步"], a: 0},
    {q: "AI 數位分身能自動處理客戶服務查詢，這提升了？", o: ["耗電量", "客戶抱怨", "法律風險", "效率"], a: 3},
    {q: "日本 AI 網紅 IMMA 的特徵是？", o: ["長髮黑色", "粉紅色短髮", "金色捲髮", "沒有頭髮"], a: 1},
    {q: "VTuber 的「直播勢」通常在哪種收益上獲利較少？", o: ["超級留言", "頻道會員", "廣告流量分紅", "周邊商品"], a: 2},
    {q: "台灣 VTuber 多數會開啟哪個贊助平台以降低抽成？", o: ["綠界", "YouTube SC", "Twitch bits", "銀行轉帳"], a: 0},
    {q: "彩虹社 FAN CLUB 擁有多少付費會員？", o: ["1 萬", "10 萬", "50 萬", "43 萬"], a: 3},
    {q: "元宇宙被 MZ 世代視為比現實世界更有趣且充滿魅力的？", o: ["陷阱", "數位代碼 (Digital Code)", "廣告", "程式錯誤"], a: 1},
    {q: "Burberry 發布的衝浪遊戲名稱為？", o: ["SurfMaster", "Waves", "BSurf", "Ocean"], a: 2},
    {q: "AI 數位分身能夠提供高度什麼化的服務和建議？", o: ["個性化", "標準化", "模糊化", "匿名化"], a: 0},
    {q: "下列何者不屬於 VTuber 事務所？", o: ["彩虹社", "Google", "Hololive", "774inc"], a: 1},
    {q: "虛擬網紅 Lu 是由哪家巴西大型物流業者開發的？", o: ["Amazon", "Shopee", "eBay", "Magalu"], a: 3},
    {q: "AI 代言人不受實體代言人的什麼爭議影響？", o: ["合約爭議或形象崩塌", "網路頻寬", "軟體更新", "伺服器地點"], a: 0},
    {q: "ZEPETO 使用者可以設計專屬空間並進行什麼活動？", o: ["實體露營", "軟體開發", "娛樂活動與溝通", "銀行轉帳"], a: 2},
    {q: "「動態立體捕捉」技術將數據壓縮後支援哪種影片格式？", o: ["AVI", "MPEG4", "WMV", "FLV"], a: 1},
    {q: "虛擬員工 Amelia 的主要業務不包括下列何者？", o: ["實體搬運", "保單審查", "人事管理", "IT 服務"], a: 0},
    {q: "21 世紀可能出現針對白領 AI 的破壞運動，類比歷史上的？", o: ["文藝復興", "工業革命", "大航海時代", "盧德運動"], a: 3},
    {q: "DHA 與 Avatar 1.0 的最大區別在於具備自主的？", o: ["顏色", "身高", "思考與對話能力 (大腦)", "名字"], a: 2},
    {q: "哪個工具可以用於創建角色和虛擬化身推廣品牌？", o: ["Excel", "Hedra", "Word", "Notepad"], a: 1},
    {q: "數位分身技術幫助企業實現即時的客戶交流與？", o: ["反饋收集", "資金盜取", "隱私侵犯", "數據損毀"], a: 0}
];

// 範例資料填充 (若您的 rawData 足夠，可直接使用 rawData)
// 這裡確保有足夠資料供 50 題測試
const completeData = rawData.length >= 50 ? rawData : [...rawData, ...rawData, ...rawData, ...rawData, ...rawData, ...rawData].slice(0, 50);

let currentQuiz = [];
let missedStats = JSON.parse(localStorage.getItem('missedStats')) || {};
let quizStartTime;
let timerInterval;

window.onload = function() {
    updateStatsDisplay();
};

function updateStatsDisplay() {
    updateFreqMissedList();
    const attempts = localStorage.getItem('totalAttempts') || 0;
    document.getElementById('total-attempts').innerText = attempts;
}

function startQuiz() {
    quizStartTime = Date.now();
    
    // 獲取使用者選擇的題數
    const qCount = parseInt(document.getElementById('question-count').value);
    
    // 從完整題庫中隨機抽取指定數量的題目
    // 為了安全起見，如果題庫總數小於選擇的數量，則使用全部題庫
    const pool = completeData;
    const actualCount = Math.min(qCount, pool.length);
    currentQuiz = pool.sort(() => 0.5 - Math.random()).slice(0, actualCount);
    
    // 更新介面上的總題數顯示
    document.getElementById('total-q-num').innerText = actualCount;

    const container = document.getElementById('questions-container');
    container.innerHTML = '';
    
    currentQuiz.forEach((q, index) => {
        const card = document.createElement('div');
        card.className = 'question-card';
        card.innerHTML = `
            <div class="question-text">:: QUERY_0${index + 1} :: <br>${q.q}</div>
            <div class="options">
                ${q.o.map((opt, optIndex) => `
                    <label onclick="selectOption(this, 'q${index}')">
                        <input type="radio" name="q${index}" value="${optIndex}">
                        <span>${opt}</span>
                    </label>
                `).join('')}
            </div>
        `;
        container.appendChild(card);
    });

    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('quiz-screen').classList.remove('hidden');
    
    // 啟動 HUD 計時器
    const timerEl = document.getElementById('quiz-timer');
    timerEl.style.display = 'block';
    
    // 重置並啟動計時
    if (timerInterval) clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        const diff = Math.floor((Date.now() - quizStartTime) / 1000);
        const m = Math.floor(diff / 60).toString().padStart(2, '0');
        const s = (diff % 60).toString().padStart(2, '0');
        timerEl.innerText = `${m}:${s}`;
    }, 1000);

    updateProgress();
    window.scrollTo(0, 0);
}

function selectOption(label, groupName) {
    const allLabels = label.parentElement.querySelectorAll('label');
    allLabels.forEach(l => l.classList.remove('selected'));
    label.classList.add('selected');
    
    // 延遲一下讓動畫跑完
    setTimeout(updateProgress, 50);
}

function updateProgress() {
    const total = currentQuiz.length;
    let answered = 0;
    currentQuiz.forEach((_, i) => {
        if(document.querySelector(`input[name="q${i}"]:checked`)) {
            answered++;
        }
    });
    
    const percentage = (answered / total) * 100;
    document.getElementById('progress-bar').style.width = `${percentage}%`;
    document.getElementById('progress-num').innerText = answered;
}

function submitQuiz() {
    // 停止計時
    clearInterval(timerInterval);
    document.getElementById('quiz-timer').style.display = 'none';

    // 計算時間
    const timeDiff = Math.floor((Date.now() - quizStartTime) / 1000);
    const minutes = Math.floor(timeDiff / 60);
    const seconds = timeDiff % 60;
    const timeString = `${minutes} 分 ${seconds} 秒`;

    // 紀錄次數
    let attempts = parseInt(localStorage.getItem('totalAttempts') || 0);
    attempts++;
    localStorage.setItem('totalAttempts', attempts);

    let score = 0;
    const reviewContainer = document.getElementById('wrong-answers-review');
    reviewContainer.innerHTML = '<h3 style="color:var(--danger); border-bottom:1px solid var(--danger); padding-bottom:10px;">[ ERROR LOGS / 錯題分析 ]</h3>';
    
    let hasWrongAnswers = false;

    currentQuiz.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const userAnswer = selected ? parseInt(selected.value) : null;
        
        if (userAnswer === q.a) {
            score++;
        } else {
            hasWrongAnswers = true;
            missedStats[q.q] = (missedStats[q.q] || 0) + 1;
            
            const div = document.createElement('div');
            div.className = 'result-item wrong';
            div.innerHTML = `
                <div style="font-weight:bold; color:#fff;">:: ERR_Q${index + 1} :: ${q.q}</div>
                <div style="margin:5px 0; color:var(--danger);">您的輸入: ${userAnswer !== null ? q.o[userAnswer] : '未作答 (NULL)'}</div>
                <div class="correct-ans-display">正確數據: ${q.o[q.a]}</div>
                <div class="explanation">
                    DATA: ${q.desc ? q.desc : 'No additional data found.'}
                </div>
            `;
            reviewContainer.appendChild(div);
        }
    });

    if (!hasWrongAnswers) {
        reviewContainer.innerHTML += `
            <div style="text-align:center; padding:20px; color:var(--success); border:1px solid var(--success);">
                <h3>>> SYSTEM PERFECT <<</h3>
                <p>無錯誤偵測，表現完美。</p>
            </div>`;
    }

    // 計算百分比 (根據實際抽出的題數 currentQuiz.length 計算)
    const totalQuestions = currentQuiz.length;
    const percentageScore = totalQuestions > 0 ? Math.round((score / totalQuestions) * 100) : 0;

    localStorage.setItem('missedStats', JSON.stringify(missedStats));
    
    // 更新 UI
    document.getElementById('score-display').innerHTML = `${percentageScore} <span class="score-unit">%</span>`;
    document.getElementById('score-detail-text').innerText = `答對: ${score} / ${totalQuestions} 題`;
    document.getElementById('time-display').innerText = `耗時: ${timeString}`;
    
    document.getElementById('quiz-screen').classList.add('hidden');
    document.getElementById('result-screen').classList.remove('hidden');
    window.scrollTo(0, 0);
}

function updateFreqMissedList() {
    const list = document.getElementById('freq-missed-list');
    const sorted = Object.entries(missedStats)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
    
    if (sorted.length === 0) {
        list.innerHTML = '<li>>> SYSTEM CLEAN. 無錯誤紀錄。</li>';
        return;
    }

    list.innerHTML = sorted.map(item => `
        <li>
            <span style="color:var(--danger);">[錯誤: ${item[1]} 次]</span> 
            ${item[0]}
        </li>
    `).join('');
}

function resetStats() {
    if(confirm('警告：此操作將清除所有系統紀錄與統計數據。確定執行？')) {
        localStorage.removeItem('missedStats');
        localStorage.removeItem('totalAttempts');
        missedStats = {};
        updateStatsDisplay();
    }
}
</script>

</body>
</html>
